{
 "align_labels_right": 0,
 "creation": "2021-08-17 19:52:01.087460",
 "css": "@font-face {\n  font-family: lato;\n  src: url('/assets/energielenker/fonts/lato-v20-latin-regular.woff2');\n}\n\n.blue-white:nth-child(odd) {\n  background-color: rgb(186, 210, 226) !important;\n}\n\n.item-table thead tr:nth-child(even) {\n    background-color: unset !important;\n    border-bottom: 3px solid rgb(186, 210, 226) !important;\n    font-weight: bold;\n}\n\n#no-bgc-table tbody tr:nth-child(odd) {\n    background-color: transparent !important;\n    padding: 0 !important;\n}\n\n#no-bgc-table tbody td {\n    padding: 0 !important;\n}\n\n.print-format {\n    font-size: 10pt;\n    margin-left: 2mm;\n    margin-right: 0mm;\n}\n\n#main_content {\n    padding-left: 55px;\n    padding-right: 55px;\n}\n\nbody {\n    padding: 0 0 5mm !important;\n    font-family: lato !important;\n}\n\n.avoidBreak { \n    page-break-inside:avoid !important;\n}",
 "custom_format": 1,
 "default_print_language": "de",
 "disabled": 0,
 "doc_type": "Sales Invoice",
 "docstatus": 0,
 "doctype": "Print Format",
 "font": "Default",
 "html": "\n<!-- Ref Data -->\n{% if doc.doctype == 'Quotation' %}\n    {% set customer = frappe.get_doc(doc.quotation_to, doc.party_name) %}\n{% else %}\n    {% set customer = frappe.get_doc(\"Customer\", doc.customer) %}\n{% endif %}\n{% if doc.contact_person %}\n{% set contact = frappe.get_doc(\"Contact\", doc.contact_person) %}\n{% endif %}\n{% if doc.doctype in ['Sales Invoice', 'Sales Order'] %}\n    {% if doc.po_no %}\n        {% set kundenreferenz = doc.po_no %}\n    {% else %}\n        {% set kundenreferenz = '' %}\n    {% endif %}\n{% endif %}\n{% if doc.project %}\n    {% set project = frappe.get_doc(\"Project\", doc.project) %}\n    {% set project_manager = frappe.get_doc(\"User\", project.project_manager) %}\n    {% if project.commercial_contact %}\n        {% set commercial_contact = frappe.get_doc(\"User\", project.commercial_contact) %}\n    {% endif %}\n{% endif %}\n{% if doc.ansprechpartner %}\n    {% set user_ansprechpartner = frappe.get_doc(\"User\", doc.ansprechpartner) %}\n{% endif %}\n{% if doc.k_ansprechperson %}\n    {% set user_ansprechperson = frappe.get_doc(\"User\", doc.k_ansprechperson) %}\n{% endif %}\n{% if doc.customer_address %}\n    {% set customer_address = frappe.get_doc(\"Address\", doc.customer_address) %}\n{% endif %}\n{% if doc.shipping_address_name %}\n    {% set shipping_address = frappe.get_doc(\"Address\", doc.shipping_address_name) %}\n{% endif %}\n{% if doc.payment_terms_template %}\n    {% set payment_terms = frappe.get_doc(\"Payment Terms Template\", doc.payment_terms_template) %}\n{% endif %}\n{% if doc.items[0].sales_order %}\n{% set sales_order = frappe.get_doc(\"Sales Order\", doc.items[0].sales_order) %}\n{% else %}\n{% set sales_order = False %}\n{% endif %}\n\n\n\n<!-- header -->\n<div id=\"header-html\" class=\"hidden-pdf\" style=\"width: 100%;\">\n    <span><img alt=\"Energielenker Solutions\" src=\"/assets/energielenker/images/Briefkopf_randlos_bogen.jpg\" style=\"height: 90px !important; margin-top: 20px; margin-left: 10px;\"></span><span><img alt=\"Energielenker Solutions\" src=\"/assets/energielenker/images/Briefkopf_randlos_logo.jpg\" style=\"height: 95px !important; margin-left: 360px;\"></span>\n</div> \n\n<!-- Adressbereich (Kunde, Ansprech.part., Komm.kont.) -->\n<table style=\"width: 100%;\">\n    <tr>\n        <td rowspan=\"3\" style=\"width: 58.7%;\">\n            <div style=\"padding-left: 75px !important; padding-top: 65px !important;\">\n            <!--Lieferschein: LS Adresse-->\n            <span><img alt=\"Energielenker Solutions\" src=\"/assets/energielenker/images/klima_zukunft_randlos.jpg\" style=\"width: 35% !important; \"></span><br>\n            <span style=\"font-size: 6.5pt; color: rgb(129, 173, 202);\">energielenker solutions GmbH | Hafenweg 15 | 48155 M\u00fcnster<br></span>\n            {% if doc.doctype == 'Delivery Note' %}\n                {% if doc.shipping_address_name %}\n                    {% if not shipping_address.address_line2 %}{{ doc.customer }}<br>\n                        {% if doc.contact_person %}{{ contact.last_name }} {{ contact.first_name }}<br>{% endif %}\n                        {{ doc.shipping_address or \"-\" }}\n                    {% else %}\n                        {{ shipping_address.address_line2 }}<br><!--Firma-->\n                        {% if doc.contact_person %}{{ contact.last_name }} {{ contact.first_name }}<br>{% endif %}\n                        {{ shipping_address.address_line1 }} {{ shipping_address.hausnummer }}<br>\n                        {{ shipping_address.plz }} {{ shipping_address.city }}\n                    {% endif %}\n                {% endif %}\n            {% else %}\n            <!--Kein Lieferschein, RG Adresse -->\n                {% if not customer_address.address_line2 %}\n                    {% if doc.doctype == 'Quotation' %} {{ doc.party_name }}<br>\n                    {% else %}{{ doc.customer }}<br>\n                    {% endif %}\n                    {% if doc.contact_person %}{{ contact.last_name }} {{ contact.first_name }}<br>{% endif %}\n                    {{ doc.address_display or \"-\" }}\n                {% else %}\n                    {{ customer_address.address_line2 }}<br><!--Firma-->\n                    {% if doc.contact_person %}{{ contact.last_name }} {{ contact.first_name }}<br>{% endif %}\n                    {{ customer_address.address_line1 }} {{ customer_address.hausnummer }}<br>\n                    {{ customer_address.plz }} {{ customer_address.city }}\n                {% endif %}\n            {% endif %}\n            </div>\n        </td>\n        <td style=\"font-size: 8pt !important;\">\n            {% if doc.ansprechpartner %}\n\t\t\t\tIhr Ansprechpartner/in:<br>\n                {{ user_ansprechpartner.full_name }}<br>\n                Tel. {{ user_ansprechpartner.phone or '-' }}<br>\n                E-Mail: {{ user_ansprechpartner.email or '-' }}\n            {% else %}\n                {% if doc.project %}\n                    {% if project_manager %}\n\t\t\t\t\t\tIhr Ansprechpartner/in:<br>\n                        {{ project_manager.full_name }}<br>\n                        Tel. {{ project_manager.phone or '-' }}<br>\n                        E-Mail: {{ project_manager.email or '-' }}\n                    {% endif %}\n                {% endif %}\n            {% endif %}\n        </td>\n    </tr>\n    <tr>\n        <td style=\"font-size: 8pt !important;\">\n            {% if doc.doctype in ['Quotation', 'Sales Order', 'Sales Invoice'] %}\n                {% if doc.k_ansprechperson %}\n                Ihr Kaufm\u00e4nnischer Ansprechpartner/in:<br>\n                    {{ user_ansprechperson.full_name }}<br>\n                    Tel. {{ user_ansprechperson.phone or '-' }}<br>\n                    E-Mail: {{ user_ansprechperson.email or '-' }}\n                {% else %}\n                    {% if commercial_contact %}\n                        Ihr Kaufm\u00e4nnischer Ansprechpartner/in:<br>\n                        {{ commercial_contact.full_name }}<br>\n                        Tel. {{ commercial_contact.phone or '-' }}<br>\n                        E-Mail: {{ commercial_contact.email or '-' }}\n                    {% endif %}\n                {% endif %}\n            {% endif %}\n        </td>\n    </tr>\n</table>\n<p><br></p>\n<div id=\"main_content\">\n    <!-- Titel und Referenzdaten -->\n    <table style=\"width: 100%;\">\n        <tr>\n            <td style=\"width: 60%; font-size: 13pt;\"><b>                                \n                {% if doc.doctype == 'Sales Order' %}\n                    {{ _(\"Auftragsbest\u00e4tigung\") }}<br>\n                {% elif doc.is_return == 1 %}\n                    {{ _(\"Gutschrift\") }}\n                {% elif doc.billing_type == 'Teilrechnung' %}\n                    {{ _(\"Teilrechnung\") }}\n                {% elif doc.billing_type == 'Schlussrechnung' %}\n                    {{ _(\"Schlussrechnung\") }}\n                {% else %}\n                    {{ _(doc.doctype) }}<br>\n                {% endif %}</b></td>\n            <td style=\"width: 40%; font-size: 10pt; \">M\u00fcnster, {% if doc.doctype in ['Quotation', 'Sales Order'] %}{{ doc.get_formatted('transaction_date') }}{% else %} {{ doc.get_formatted('posting_date') }}{% endif %}</td>\n        </tr>\n    </table>\n\n    <!-- Items & Referenzdaten Table -->\n    <table class=\"item-table\" style=\"width: 100%;\">\n        <thead>\n            <tr>\n                {% if doc.doctype == 'Delivery Note' %}\n                <td colspan=\"3\">\n                {% else %}\n                <td colspan=\"5\">\n                {% endif %}\n                    <!-- Referenzdaten Table -->\n                    <table id=\"no-bgc-table\" style=\"width: 100%;\">\n                        <tr>\n                            <td style=\"width: 30%;\">\n                                {% if doc.doctype == 'Quotation' %}\n                                    Angebots-Nr:<br>\n                                {% elif doc.doctype == 'Sales Order' %}\n                                    Auftrags-Nr:<br>\n                                {% elif doc.doctype == 'Sales Invoice' %}\n                                    Rechnungs-Nr:<br>\n                                {% else %}\n                                    {{ _(doc.doctype) }}-nummer:<br>\n                                {% endif %}\n                                Kunden-Nr:<br>\n                                Projekt-Nr:<br>\n                                {% if kundenreferenz %}\n                                    Ihre Referenz-Nr:\n                                {% endif %}\n                            </td>\n                            <td style=\"width: 31%; text-align: left; \">\n                                {{ doc.name }}<br>\n                                {{ customer.navision_nr or \"-\" }}<br>\n                                {{ doc.project or '-' }}<br>\n                                {% if kundenreferenz %}\n                                    {{ kundenreferenz }}\n                                {% endif %}\n                            </td>\n                            <td style=\"width: 39%\">\n                            {% if doc.doctype == 'Delivery Note' %}\n                                {{ _(\"Rechnunganschrift\") }}\n                                {% if not customer_address.address_line2 %}\n                                    {{ doc.customer }}<br>\n                                    {{ doc.address_display or \"-\"}}\n                                {% else %}\n                                    {{ doc.address_display }}\n                                {% endif %}\n                            <!--Kein LS, lieferadresse hier -->\n                            {% else %}\n                                {% if doc.shipping_address_name %}\n                                    {{ _(\"Lieferanschrift\") }}<br>\n                                        {% if shipping_address.address_line2 %}\n                                            {{ doc.shipping_address or \"-\" }}\n                                        {% else %}\n                                            {% if doc.doctype == 'Quotation' %} {{ doc.party_name }}<br>\n                                            {% else %}{{ doc.customer }}<br>\n                                            {% endif %}\n                                            {{ doc.shipping_address or \"-\" }}\n                                        {% endif %}\n                                {% endif %}\n                            {% endif %}\n                            </td>\n                        </tr>\n                    </table>\n                </td>\n            </tr>\n            <tr>\n                <!-- Items Table -->\n                <td style=\"width: 5%; text-align: center; padding-top: 15px !important;\">Pos.</td>\n                <td style=\"width: 45%; padding-top: 15px !important;\">Beschreibung</td>\n                {% if doc.doctype == 'Delivery Note' %}\n                <td style=\"width: 50%;padding-top: 15px !important; text-align: right;\">Menge</td>\n                {% else %}\n                <td style=\"width: 10%; padding-top: 15px !important; text-align: right;\">Menge</td>\n                <td style=\"width: 20%; padding-top: 15px !important; text-align: right;\">Preis</td>\n                <td style=\"width: 20%;padding-top: 15px !important; text-align: right;\">Betrag</td>\n                {% endif %}\n            </tr>\n        </thead>\n        <tbody>\n            {% if doc.doctype == 'Delivery Note' %}\n                {% for item in doc.items %}\n                {% if item.item_group != 'Verpackung / Versand' %}\n                <tr style=\"background-color: rgb(186, 210, 226) !important;\">\n                    <td style=\"border-right: 1px solid rgb(186, 210, 226) !important; text-align: center;\"><b>{{ loop.index }}</b></td>\n                    <td style=\"border-right: 1px solid rgb(186, 210, 226) !important;\">{{ item.item_name }}</td>\n                    <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\">{{ item.qty }}</td>\n                </tr>\n                {% endif %}\n                {% endfor %}\n            {% else %}\n                <!-- variable f\u00fcr positionsnummer -->\n                {% set position = {'nummer': 1} %}\n                <!-- variable f\u00fcr kalkulationssumme -->\n                {% set kalksum = {'total': 0} %}\n                <!-- Items Table -->\n                <!-- pro item -->\n                {% for item in doc.items %}\n\t\t\t\t{% if not item.is_supplement %}\n                    <!-- interne position -->\n                    {% if item.interne_position %}\n                        <!-- add amount to kalkulationssumme -->\n                        {% if kalksum.update({'total': kalksum.total + item.amount}) %}{% endif %}\n                    <!-- Kalkulationssumme -->\n                    {% elif item.kalkulationssumme_interner_positionen %}\n                        <!-- add amount to kalkulationssumme -->\n                        {% if kalksum.update({'total': kalksum.total + item.amount}) %}{% endif %}\n                        <!-- print kalkulationssumme -->\n                        <tr style=\"background-color: rgb(186, 210, 226) !important;\">\n                            <td style=\"border-right: 1px solid rgb(186, 210, 226) !important; text-align: center;\"><b>{{ position.nummer }}</b></td>\n                            <!-- increment positionsnummer -->\n                            {% if position.update({'nummer': position.nummer + 1}) %}{% endif %}\n                            <td style=\"border-right: 1px solid rgb(186, 210, 226) !important;\">{{ item.item_name }}</td>\n                            <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\">1</td>\n                            <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\">\u20ac {{ \"{:,.2f}\".format(kalksum.total).replace(\",\", \"'\").replace(\".\", \",\").replace(\"'\", \".\") }}</td>\n                            <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\">\u20ac {{ \"{:,.2f}\".format(kalksum.total).replace(\",\", \"'\").replace(\".\", \",\").replace(\"'\", \".\") }}</td>\n                        </tr>\n                        {% for line in item.description.split(\"</div>\") %}\n                            <tr style=\"background-color: transparent !important;\">\n                                <td style=\"border-right: 1px solid rgb(186, 210, 226) !important;\"></td>\n                                <td colspan=\"3\" style=\"border-right: 1px solid rgb(186, 210, 226) !important;\">{{ line + '</div>' }}</td>\n                                <td></td>\n                            </tr>\n                        {% endfor %}\n                        <!-- reset kalkulationssumme -->\n                        {% if kalksum.update({'total': 0}) %}{% endif %}\n                    <!-- anderes -->\n                    {% else %}\n                        <!-- Versandkosten werden als Totalposition behandelt -->\n                        {% if item.item_group != 'Verpackung / Versand' %}\n                            <tr style=\"background-color: rgb(186, 210, 226) !important;\">\n                                <td style=\"border-right: 1px solid rgb(186, 210, 226) !important; text-align: center;\"><b>{{ position.nummer }}</b></td>\n                                <!-- increment positionsnummer -->\n                                {% if position.update({'nummer': position.nummer + 1}) %}{% endif %}\n                                <td style=\"border-right: 1px solid rgb(186, 210, 226) !important;\">{% if item.alternative_position %}Optional:<br>{% endif %}{{ item.item_name }}</td>\n                                <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\">{% if not item.textposition %}{{ item.qty }}{% endif %}</td>\n                                {% if item.discount_percentage and not item.textposition %}\n                                    {% if not item.alternative_position %}\n                                    <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\">\n                                        {{ item.get_formatted('price_list_rate') }}<br>\n                                        -{{ item.discount_percentage }}%<br>\n                                        {{ item.get_formatted('rate') }}\n                                    </td>\n                                    <td style=\"text-align: right;\">{{ item.get_formatted('amount') }}</td>\n                                    {% else %}\n                                        <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\">{{ item.get_formatted('preis_alternative_position') }}</td>\n                                        <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"></td>\n                                    {% endif %}\n                                {% else %}\n                                    {% if not item.textposition %}\n                                        <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\">\n                                            {{ item.get_formatted('rate') }}\n                                        </td>\n                                        <td style=\"text-align: right;\">{{ item.get_formatted('amount') }}</td>\n                                    {% else %}\n                                        <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"></td>\n                                        <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"></td>\n                                    {% endif %}\n                                {% endif %}\n                            </tr>\n                            {% for line in item.description.split(\"</div>\") %}\n                                <tr style=\"background-color: transparent !important;\">\n                                    <td style=\"border-right: 1px solid rgb(186, 210, 226) !important;\"></td>\n                                    <td colspan=\"3\" style=\"border-right: 1px solid rgb(186, 210, 226) !important;\">{{ line + '</div>' }}</td>\n                                    <td></td>\n                                </tr>\n                            {% endfor %}\n                        {% endif %}\n                    {% endif %}\n\t\t\t\t{% endif %}<!--Ende: if not item.is_supplement / Nachtragsposition-->\n                {% endfor %}\n                <!-- Total Zeilen -->\n                {% for item in doc.items %}\n                    {% if item.item_group == 'Verpackung / Versand' %}\n                        <tr class=\"blue-white\">\n                            <td colspan=\"4\" style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\">{{ item.item_name }}</td>\n                            <td style=\"text-align: right;\">{{ item.get_formatted('amount') }}</td>\n                        </tr>\n                    {% endif %}\n                {% endfor %}\n\t\t\t\t<!--insert Abschlag -->\n\t\t\t\t{% if doc.billing_type == 'Schlussrechnung' %}\n\t\t\t\t\t{% if sales_order %}\n\t\t\t\t\t\t<!--Abschlagsposition-->\n\t\t\t\t\t\t<tr style=\"background-color: rgb(186, 210, 226) !important;\">\n\t\t\t\t\t\t\t<td style=\"text-align: center;\"><b>{{ position.nummer }}</b></td>\n\t\t\t\t\t\t\t<td colspan = '4' style=\"font-size: 7.5pt;\">{{ _(\"Folgende Abschlagsrechnungen wurden Ihnen bereits zugesandt.<br>Zahlungseing\u00e4nge sind aufgef\u00fchrt soweit bereits gebucht.\") }}</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t{% set vars1 = {'sum_net_total': 0} %}\n\t\t\t\t\t\t{% set vars2 = {'sum_brut_total': 0} %}\n\t\t\t\t\t\t{% set vars3 = {'sum_taxes': 0} %}\n\t\t\t\t\t\t{% for billed in sales_order.billing_overview %}\n\t\t\t\t\t\t{% if vars1.update({'sum_net_total': vars1.sum_net_total + (sales_order.total * billed.billing_portion/100)}) %}{% endif %}\n\t\t\t\t\t\t{% if vars2.update({'sum_brut_total': vars2.sum_brut_total + (sales_order.grand_total * billed.billing_portion/100) }) %}{% endif %}\n\t\t\t\t\t\t{% if vars3.update({'sum_taxes': vars3.sum_taxes + (sales_order.taxes[0]['rate']/100 * sales_order.total * billed.billing_portion/100) }) %}{% endif %}\n\t\t\t\t\t\t<tr><!--Anzahlungen (Position.1, Position.2 etc)-->\n\t\t\t\t\t\t\t<td style=\"text-align: center; border-right: 1px solid rgb(186, 210, 226) !important;\"><i>{{ position.nummer }}.{{ billed.idx }}</i></td>\n\t\t\t\t\t\t\t<td><i>{{ _(\"Abschlag\") }}</i></td>\n\t\t\t\t\t\t\t<td style=\"text-align: right;\"><i>{{ _(\"1\") }}</i></td>\n\t\t\t\t\t\t\t<td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"><i>\u20ac -{{ \"{:,.2f}\".format(sales_order.total * billed.billing_portion/100).replace(\".\", \",\").replace(\"'\", \".\") }}</i></td>\n\t\t\t\t\t\t\t<td style=\"text-align: right; \"><i>\u20ac -{{ \"{:,.2f}\".format(sales_order.total * billed.billing_portion/100).replace(\",\", \"'\").replace(\".\", \",\").replace(\"'\", \".\") }}</i></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr style=\"font-size: 7.5pt;\">\n\t\t\t\t\t\t\t<td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"></td>\n\t\t\t\t\t\t\t<td colspan=\"3\" style=\"border-right: 1px solid rgb(186, 210, 226) !important;\">{{ _(\"Abschlag\") }} 1: {{ _(\"Rechnung-Nr.\") }} {{ sales_order.name }} | {{ loop.index }} {{ _(\"vom\") }} {{ billed.get_formatted('creation_date') }}</td>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"></td>\n\t\t\t\t\t\t\t<td colspan=\"3\" style=\" padding: 0px !important;\"> <!--Auflistung n+ Abschl\u00e4ge-->\n\t\t\t\t\t\t\t\t<table style=\"width: 100%; font-size: 7.5pt;\">\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<td style=\"width: 30%;\">\n\t\t\t\t\t\t\t\t\t\t- {{ _(\"Nettobetrag\") }}:<br>\n\t\t\t\t\t\t\t\t\t\t- {{ _(\"Mehrwertsteuer\") }}:<br>\n\t\t\t\t\t\t\t\t\t\t- {{ _(\"Bruttobetrag\") }}:<br>\n\t\t\t\t\t\t\t\t\t\t- {{ _(\"Zahlungseingang\") }}:\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t<td style=\"text-align: right;\">\n\t\t\t\t\t\t\t\t\t\t\u20ac {{ \"{:,.2f}\".format(sales_order.total * billed.billing_portion/100).replace(\",\", \"'\").replace(\".\", \",\").replace(\"'\", \".\") }}<br>\n\t\t\t\t\t\t\t\t\t\t\u20ac {{ \"{:,.2f}\".format(sales_order.taxes[0]['rate']/100 * sales_order.total * billed.billing_portion/100).replace(\",\", \"'\").replace(\".\", \",\").replace(\"'\", \".\") }}<br>\n\t\t\t\t\t\t\t\t\t\t\u20ac {{ \"{:,.2f}\".format(sales_order.grand_total * billed.billing_portion/100).replace(\",\", \"'\").replace(\".\", \",\").replace(\"'\", \".\") }}<br>\n\t\t\t\t\t\t\t\t\t\t{% if doc.advances|len > 0 %}\n\t\t\t\t\t\t\t\t\t\t\t<!-- variable f\u00fcr gefundene zahlung -->\n\t\t\t\t\t\t\t\t\t\t\t{% set zahlung = {'gefunden': 0} %}\n\t\t\t\t\t\t\t\t\t\t\t<!--find payment entry for this Teilrechnung-->\n\t\t\t\t\t\t\t\t\t\t\t{% for payment in doc.advances %}\n\t\t\t\t\t\t\t\t\t\t\t\t{% if zahlung.gefunden == 0 %}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{% set payment_entry = frappe.get_doc(\"Payment Entry\", payment.reference_name) %}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{% if billed.idx == payment_entry.verrechnungsstufe %}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\u20ac {{ \"{:,.2f}\".format(payment.allocated_amount).replace(\",\", \"'\").replace(\".\", \",\").replace(\"'\", \".\") }}<br>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{% if zahlung.update({'gefunden': 1}) %}{% endif %}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{% endif %}\n\t\t\t\t\t\t\t\t\t\t\t\t{% endif %}\n\t\t\t\t\t\t\t\t\t\t\t{% endfor %}\n\t\t\t\t\t\t\t\t\t\t\t{% if zahlung.gefunden == 0 %}\n\t\t\t\t\t\t\t\t\t\t\t-\n\t\t\t\t\t\t\t\t\t\t\t{% endif %}\n\t\t\t\t\t\t\t\t\t\t{% endif %}\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t<td style=\"border-right: 1px solid rgb(186, 210, 226) !important; width: 50%;\">&nbsp;</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</table>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t{% endfor %}\n\t\t\t\t\t{% else %}\n\t\t\t\t\t\t<tr style=\"background-color: red !important;\">\n\t\t\t\t\t\t\t<td colspan = '5' style=\"font-size: 7.5pt;\">Bitte befolgen Sie den korrekten Prozess zur Erstellung einer Schlussrechnung! (Erstellung Rechnung aus Auftragsbest\u00e4tigung)</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t{% endif %}\n\t\t\t\t{% endif %}\n\t\t\t\t<!--Ende Abschlag -->\n\t\t\t\t<!--Nachtragsposition-->\n\t\t\t\t{% for item in doc.items %}\n\t\t\t\t\t{% if item.is_supplement %}\n\t\t\t\t\t{% if position.update({'nummer': position.nummer + 1}) %}{% endif %}\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td style=\"border-right: 1px solid rgb(186, 210, 226) !important;\"></td>\n\t\t\t\t\t\t<td colspan= '3' style=\"border-right: 1px solid rgb(186, 210, 226) !important;\"><b>{{ _(\"Nachtrag/Zus\u00e4tzlicher Aufwand\") }}</b></td>\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr style=\"background-color: rgb(186, 210, 226) !important;\">\n\t\t\t\t\t\t<td style=\"text-align: center; border-right: 1px solid rgb(186, 210, 226) !important;\"><b>{{ position.nummer }}</b></td>\n\t\t\t\t\t\t<td>{{ item.item_code }}</td>\n\t\t\t\t\t\t<td style=\"text-align: right;\">{{ item.qty }}</td>\n\t\t\t\t\t\t<td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\">\u20ac {{ \"{:,.2f}\".format(item.rate).replace(\".\", \",\").replace(\"'\", \".\") }}</td>\n\t\t\t\t\t\t<td style=\"text-align: right; \">\u20ac {{ \"{:,.2f}\".format(item.amount).replace(\".\", \",\").replace(\"'\", \".\") }}</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t{% for line in item.description.split(\"</div>\") %}\n\t\t\t\t\t\t<tr style=\"background-color: transparent !important;\">\n\t\t\t\t\t\t\t<td style=\"border-right: 1px solid rgb(186, 210, 226) !important;\"></td>\n\t\t\t\t\t\t\t<td colspan=\"3\" style=\"border-right: 1px solid rgb(186, 210, 226) !important;\">{{ line + '</div>' }}</td>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t</tr>\n                    {% endfor %}\n\t\t\t\t\t{% endif %}\n\t\t\t\t{% endfor %}\n\t\t\t\t<!--Ende Nachtragsposition-->\n                <tr class=\"blue-white\">\n                    <td style=\"background-color: white !important\" colspan =\"3\"></td>\n                    <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"><b>\n\t\t\t\t\t{% if doc.discount_amount %}{{ _(\"Zwischensumme\") }}{% else %}{{_(\"Summe netto\") }}{% endif %}</b></td>\n                    <td style=\"text-align: right;\">\n\t\t\t\t\t{% if doc.billing_type == 'Schlussrechnung' %}\u20ac {{ \"{:,.2f}\".format(doc.total - vars1.sum_net_total).replace(\".\", \",\").replace(\"'\", \".\") }}\n\t\t\t\t\t{% else %}{{ doc.get_formatted('total') }}\n\t\t\t\t\t{% endif %}</td>\n                </tr>\n                {% if doc.discount_amount %}\n                <tr class=\"blue-white\">\n                    <td style=\"background-color: white !important\" colspan =\"3\"></td>\n                    <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"><b>{{ _(\"Rabatt\") }}</b></td>\n                    <td style=\"text-align: right;\">{% if doc.additional_discount_percentage %}(-{{ doc.get_formatted('additional_discount_percentage') }} %){% endif %} \u20ac {% if doc.doctype == 'Quotation' %}{% else %} -{% endif %}{{ \"{:,.2f}\".format(doc.discount_amount).replace(\",\", \"'\").replace(\".\", \",\").replace(\"'\", \".\") }} </td>\n                </tr>\n                <tr class=\"blue-white\">\n                    <td style=\"background-color: white !important\" colspan =\"3\"></td>\n                    <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"><b>{{ _(\"Summe netto\") }}</b></td>\n                    <td style=\"text-align: right;\">{% if doc.billing_type == 'Schlussrechnung' %}\u20ac {{ \"{:,.2f}\".format(doc.net_total - vars1.sum_net_total).replace(\".\", \",\").replace(\"'\", \".\") }}{% else %}{{ doc.get_formatted('net_total') }}{% endif %}</td>\n                </tr>\n                {% endif %}\n                <tr class=\"blue-white\">\n                    <td style=\"background-color: white !important\" colspan =\"3\"></td>\n                    <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"><b>zzgl. 19% MwSt.</b></td>\n                    <td style=\"text-align: right;\">{% if doc.advances|len > 0 %}\u20ac {{ \"{:,.2f}\".format(doc.total_taxes_and_charges - vars3.sum_taxes).replace(\".\", \",\").replace(\"'\", \".\") }}{% else %}{{ doc.get_formatted('total_taxes_and_charges') }}{% endif %}</td>\n                </tr>\n                <tr class=\"blue-white\">\n                    <td style=\"background-color: white !important\" colspan =\"3\"></td>\n                    <td style=\"text-align: right; border-right: 1px solid rgb(186, 210, 226) !important;\"><b>Summe brutto</b></td>\n                    <td style=\"text-align: right;\">{% if doc.billing_type == 'Schlussrechnung' %}\u20ac {{ \"{:,.2f}\".format(doc.grand_total - vars2.sum_brut_total).replace(\".\", \",\").replace(\"'\", \".\") }}{% else %}{{ doc.get_formatted('grand_total') }}{% endif %}</td>\n                </tr>\n            {% endif %}\n        </tbody>\n    </table>\n</div>\n\n<div style=\"padding-left: 55px; page-break-inside: avoid;\">\n<!--Zahlungsbedingungen, auch ohne Template abdrucken-->\n{% if doc.doctype == 'Sales Invoice' %}\n\t<br>{{ _(\"Soweit nicht anders angegeben gilt, Leistungsdatum = Rechnungsdatum.\") }}<br>\n\t<br>\n{% endif %}\n{% if doc.payment_schedule|len > 0 %}<br>\n\t<b>Zahlungsbedingungen:</b><br>\n\t{% if doc.payment_terms_template %}\n\t\t{% if payment_terms.skonto_percent %}\n\t\t{{ payment_terms.skonto_percent }} % Skonto bei Zahlungseingang innerhalb von {{ payment_terms.skonto_days }} Tagen<br>\n\t\t{% endif %}\n\t{% endif %}\n\t{% for ps in doc.payment_schedule %}\n\t{{ ps.invoice_portion }}% ({{ ps.get_formatted('payment_amount') }}) {% if doc.doctype == 'Sales Invoice' %} per {{ ps.get_formatted('due_date') or \"\" }}{% else %} {{ ps.description or \"\" }}{% endif %}<br>\n\t{% endfor %}\n{% endif %}\n{% if doc.doctype != 'Sales Invoice' %}\n\t{% if doc.lieferzeit %}<br>\n\t\t<b>Lieferzeit:</b> {{ doc.lieferzeit }}<br>\n\t{% endif %}\n{% endif %}\n{% if doc.doctype == 'Quotation' %}<br>\n\t<b>Angebotsg\u00fcltigkeit:</b> {{ doc.get_formatted('valid_till') }}<br>\n{% endif %}\n{% if doc.terms %}<br>{{ doc.terms }}{% endif %}\n</div>\n<div style=\"padding-left: 55px; page-break-inside: avoid;\">\n\t<br>Mit freundlichen Gr\u00fc\u00dfen\n\t<p><br></p>\n\t<b>energielenker solutions GmbH</b>\n\t<p><br></p>\n\tppa. Markus Grosse Gorgemann<br><br>\n\t<i>(dieses Schreiben wurde maschinell erstellt und ist auch ohne Unterschrift g\u00fcltig)</i>\n</div>\n\n<!-- Footer -->\n<div id=\"footer-html\" class=\"visible-pdf\">\n    <p style=\"padding: 5mm 0 0 55px !important;\">\n        energielenker solutions GmbH <b>Gesch\u00e4ftsf\u00fchrer</b> Tobias Dollberg, Christian Fuchte<br>\n        <b>Amtsgericht M\u00fcnster</b> HRB 16647 <b>Sitz</b> M\u00fcnster <b>Steuer-Nr.</b> 327/5780/8051 <b>USt-Id-Nr.</b> DE300828709<br>\n        <b>Bankverbindung</b> Sparkasse Emsdetten Ochtrup <b>IBAN</b> DE78 4015 3768 0000 2103 95 <b>BIC</b> WELADED1EMS\n    </p>\n    <p style=\"font-size: 8pt !important; text-align: center; \">{{ _(\"Page\") }} <span class=\"page\"></span> {{ _(\"of\") }} <span class=\"topage\"></span></p>\n</div>",
 "idx": 0,
 "line_breaks": 0,
 "modified": "2021-10-15 13:39:54.529328",
 "modified_by": "Administrator",
 "module": "energielenker",
 "name": "Rechnung (EL)",
 "owner": "Administrator",
 "parent": "Sales Invoice",
 "print_format_builder": 1,
 "print_format_type": "Jinja",
 "raw_printing": 0,
 "show_section_headings": 0,
 "standard": "Yes"
}